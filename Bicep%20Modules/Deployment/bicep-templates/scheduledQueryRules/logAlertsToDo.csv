actionGroupName,name,enabled,kind,severity,conditionQuery,conditionResourceIdColumn,dimensionName,secondDimensionName,conditionMetricMeasureColumn,conditionTimeAggregation,conditionOperator,conditionThreshold,evaluationFrequency,minFailingPeriodsToAlert,numberOfEvaluationPeriods,windowSize,autoMitigate,Scopes
emailReceiver,Azure VPN Gateway Connection Shared Key Mismatch,TRUE,LogAlert,1,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n   and  stateChangeReason_s    =='PresharedKey changed'\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
emailReceiver,Azure VPN Gateway Connection Removed,TRUE,LogAlert,1,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n   and  stateChangeReason_s    =='TunnelRemoved'\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
emailReceiver,Azure VPN Gateway Remote Endpoint Disconnected,TRUE,LogAlert,2,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n   and  stateChangeReason_s    =='Remotely triggered'\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
emailReceiver,Azure VPN Gateway Connection Error Occurred,TRUE,LogAlert,2,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n| where not(stateChangeReason_s has_any('Standby changed','GlobalStandby changed','Remotely triggered','TunnelRemoved','PresharedKey changed','DPD timed out'))\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
emailReceiver,Azure VPN Gateway Primary Instance Changed,TRUE,LogAlert,3,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n| where stateChangeReason_s has_any('Standby changed','GlobalStandby changed')\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
emailReceiver,Azure VPN Gateway Connection DPD Timeout Occurred,TRUE,LogAlert,2,"AzureDiagnostics \n| where TimeGenerated >= ago(5m) \n| where Category               =='TunnelDiagnosticLog'\n   and  status_s               =='Disconnected'\n   and  stateChangeReason_s    =='DPD timed out'\n| extend TimeGeneratedUTC = tostring(TimeGenerated)\n| project TimeGeneratedUTC, ResourceGroup,Resource,ResourceType,status_s,stateChangeReason_s,ResourceId",ResourceId,TimeGeneratedUTC,ResourceId,,Count,GreaterThan,0,PT5M,1,1,PT5M,TRUE,/subscriptions/8a1389fe-c983-4fc3-99ad-b7413829bcd3
